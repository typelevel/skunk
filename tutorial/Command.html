<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>Commands</title>
  
  <meta name="author" content="Rob Norris"/>
  
  
  <meta name="description" content="docs"/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="https://typelevel.org/img/favicon.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../helium/site/laika-helium.css" />
  <script src="../helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="https://typelevel.org"><img src="https://typelevel.org/img/logo.svg"></a>

  <div class="row links">
    
    <a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/"><span class="api" title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a>
    
    <a class="icon-link svg-link" href="https://github.com/typelevel/skunk"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
    <a class="icon-link svg-link" href="https://fosstodon.org/@typelevel"><span class="mastodon" title="Mastodon"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <g class="svg-shape">
    <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"/>
  </g>
</svg></span></a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="icon-link svg-link" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/"><span class="api" title="API"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M75,47.5c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm-50,-0c13.246,-0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,-0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm2.705,16.735l7.239,0l0.622,-4.904l-21.833,0l-0,4.904l7.589,0l0,22.067l6.383,0l-0,-22.067Zm58.076,7.265c-0,-8.757 -3.698,-14.166 -10.781,-14.166c-7.083,-0 -10.781,5.604 -10.781,14.166c0,8.757 3.698,14.166 10.781,14.166c7.083,0 10.781,-5.604 10.781,-14.166Zm-6.539,0c0,6.538 -1.128,9.496 -4.242,9.496c-2.997,0 -4.242,-2.88 -4.242,-9.496c-0,-6.616 1.206,-9.496 4.242,-9.496c3.036,-0 4.242,2.88 4.242,9.496Zm-29.242,-67c13.246,0 24,10.754 24,24c0,13.246 -10.754,24 -24,24c-13.246,0 -24,-10.754 -24,-24c0,-13.246 10.754,-24 24,-24Zm0.512,9.834c-7.122,-0 -12.609,5.098 -12.609,14.127c-0,9.263 5.215,14.205 12.532,14.205c4.164,0 7.083,-1.634 9.068,-3.658l-2.88,-3.697c-1.518,1.206 -3.153,2.413 -5.838,2.413c-3.697,-0 -6.266,-2.763 -6.266,-9.263c-0,-6.616 2.724,-9.379 6.149,-9.379c2.102,-0 3.892,0.778 5.371,1.984l3.113,-3.775c-2.257,-1.868 -4.748,-2.957 -8.64,-2.957Z"/>
  </g>
</svg></span></a>
    
    <a class="icon-link svg-link" href="https://github.com/typelevel/skunk"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
    <a class="icon-link svg-link" href="https://fosstodon.org/@typelevel"><span class="mastodon" title="Mastodon"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <g class="svg-shape">
    <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"/>
  </g>
</svg></span></a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="../">Skunk</a></li>
    <li class="level1 nav-header">Tutorial</li>
    <li class="level2 nav-leaf"><a href="index.html">Intro</a></li>
    <li class="level2 nav-leaf"><a href="Setup.html">Setup</a></li>
    <li class="level2 nav-leaf"><a href="Query.html">Queries</a></li>
    <li class="level2 active nav-leaf"><a href="#">Commands</a></li>
    <li class="level2 nav-leaf"><a href="Transactions.html">Transactions</a></li>
    <li class="level2 nav-leaf"><a href="Channels.html">Channels</a></li>
    <li class="level2 nav-leaf"><a href="Tracing.html">Tracing</a></li>
    <li class="level1 nav-header">Reference</li>
    <li class="level2 nav-leaf"><a href="../reference/">Intro</a></li>
    <li class="level2 nav-leaf"><a href="../reference/Sessions.html">Sessions</a></li>
    <li class="level2 nav-leaf"><a href="../reference/TwiddleLists.html">Twiddle Lists</a></li>
    <li class="level2 nav-leaf"><a href="../reference/Encoders.html">Encoders</a></li>
    <li class="level2 nav-leaf"><a href="../reference/Fragments.html">Fragments</a></li>
    <li class="level2 nav-leaf"><a href="../reference/Identifiers.html">Identifiers</a></li>
    <li class="level2 nav-leaf"><a href="../reference/Concurrency.html">Concurrency</a></li>
    <li class="level2 nav-leaf"><a href="../reference/SchemaTypes.html">Schema Types</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">Commands</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#simple-command">Simple Command</a></li>
    <li class="level1 nav-node"><a href="#parameterized-command">Parameterized Command</a></li>
    <li class="level2 nav-leaf"><a href="#contramapping-commands">Contramapping Commands</a></li>
    <li class="level1 nav-leaf"><a href="#list-parameters">List Parameters</a></li>
    <li class="level1 nav-leaf"><a href="#summary-of-command-types">Summary of Command Types</a></li>
    <li class="level1 nav-leaf"><a href="#full-example">Full Example</a></li>
    <li class="level1 nav-leaf"><a href="#experiment">Experiment</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="commands" class="title">Commands</h1>
        <p>This section explains how to construct and execute commands.</p>
        <div class="callout info">
          <i class="icofont-laika info">&#xef4e;</i>
          <p>A <em>command</em> is a SQL statement that does not return rows.</p>
        </div>
        
        <h2 id="simple-command" class="section"><a class="anchor-link left" href="#simple-command"><i class="icofont-laika link">&#xef71;</i></a>Simple Command</h2>
        <p>First let&#39;s look at a command that sets the session&#39;s random number seed.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">a</span><span>: </span><span class="type-name">Command</span><span>[</span><span class="type-name">Void</span><span>] =
  </span><span class="string-literal">sql&quot;SET SEED TO 0.123&quot;</span><span>.</span><span class="identifier">command</span><span>
</span><span class="comment">// a: Command[Void] = Command(
//   sql = &quot;SET SEED TO 0.123&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 33),
//   encoder = Codec(void)
// )</span></code></pre>
        <p>Observe the following:</p>
        <ul>
          <li>We are using the <a href="../reference/Fragments.html">sql interpolator</a> to construct a <a class="api" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/skunk/Fragment.html">Fragment</a>, which we then turn into a <a class="api" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/skunk/Command.html">Command</a> by calling the <code>command</code> method.</li>
          <li><code>Command</code> is parameterized by its input type. Because this command has no parameters the input type is <code>Void</code>.</li>
        </ul>
        <p>The command above is a <em>simple command</em>.</p>
        <div class="callout info">
          <i class="icofont-laika info">&#xef4e;</i>
          <p>A <em>simple command</em> is a command with no parameters.</p>
        </div>
        <p>The same <a href="https://www.postgresql.org/docs/10/protocol-flow.html#id-1.10.5.7.4">protocol</a> that executes simple queries also executes simple commands. Such commands can be passed directly to <a class="api" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/skunk/Session.html">Session</a>#execute.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="identifier">s</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">a</span><span>) </span><span class="comment">// IO[Completion]</span></code></pre>
        <p>On success a command will yield a <a class="api" href="https://www.javadoc.io/doc/org.tpolecat/skunk-docs_2.13/0.6.5/skunk/data/Completion.html">Completion</a>, which is an ADT that encodes responses from various commands. In this case our completion is simply the value <code>Completion.Set</code>.</p>
        
        <h2 id="parameterized-command" class="section"><a class="anchor-link left" href="#parameterized-command"><i class="icofont-laika link">&#xef71;</i></a>Parameterized Command</h2>
        <p>Now let&#39;s add a parameter to the command.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">c</span><span>: </span><span class="type-name">Command</span><span>[</span><span class="type-name">String</span><span>] =
  </span><span class="string-literal">sql&quot;DELETE FROM country WHERE name = </span><span class="substitution">$varchar</span><span class="string-literal">&quot;</span><span>.</span><span class="identifier">command</span><span>
</span><span class="comment">// c: Command[String] = Command(
//   sql = &quot;DELETE FROM country WHERE name = $1&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 51),
//   encoder = Codec(varchar)
// )</span></code></pre>
        <p>Observe that we have interpolated a value called <code>varchar</code>, which has type <code>Encoder[String]</code>. This works the same way as with queries. See the previous chapter for more information about statement parameters.</p>
        <p>The command above is an <em>extended command</em>.</p>
        <div class="callout warning">
          <i class="icofont-laika warning">&#xf026;</i>
          <p>An <em>extended command</em> is a command with parameters, or a simple command that is executed via the extended query protocol.</p>
        </div>
        <p>The same protocol Postgres provides for executing extended queries is also used for extended commands, but because the return value is always a single <code>Completion</code> the end-user API is more limited.</p>
        <p>Here we use the extended protocol to attempt some deletions.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">c</span><span>).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">pc</span><span> =&gt;
  </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="string-literal">&quot;xyzzy&quot;</span><span>) *&gt;
  </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="string-literal">&quot;fnord&quot;</span><span>) *&gt;
  </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="string-literal">&quot;blech&quot;</span><span>)
} </span><span class="comment">// IO[Completion]</span></code></pre>
        <p>If we&#39;re slighly more clever we can do this with <code>traverse</code> and return a list of <code>Completion</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">c</span><span>).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">pc</span><span> =&gt;
  </span><span class="type-name">List</span><span>(</span><span class="string-literal">&quot;xyzzy&quot;</span><span>, </span><span class="string-literal">&quot;fnord&quot;</span><span>, </span><span class="string-literal">&quot;blech&quot;</span><span>).</span><span class="identifier">traverse</span><span>(</span><span class="identifier">s</span><span> =&gt; </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">s</span><span>))
} </span><span class="comment">// IO[List[Completion]]</span></code></pre>
        <p>And if we&#39;re yet more clever we can turn <code>pc</code> into an fs2 <code>Pipe</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="type-name">Stream</span><span>.</span><span class="identifier">eval</span><span>(</span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">c</span><span>)).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">pc</span><span> =&gt;
  </span><span class="type-name">Stream</span><span>(</span><span class="string-literal">&quot;xyzzy&quot;</span><span>, </span><span class="string-literal">&quot;fnord&quot;</span><span>, </span><span class="string-literal">&quot;blech&quot;</span><span>).</span><span class="identifier">through</span><span>(</span><span class="identifier">pc</span><span>.</span><span class="identifier">pipe</span><span>)
} </span><span class="comment">// Stream[IO, Completion]</span></code></pre>
        
        <h3 id="contramapping-commands" class="section"><a class="anchor-link left" href="#contramapping-commands"><i class="icofont-laika link">&#xef71;</i></a>Contramapping Commands</h3>
        <p>Similar to <code>map</code>ping the <em>output</em> of a Query, we can <code>contramap</code> the <em>input</em> to a command or query. Here we provide a function that turns an <code>Info</code> into a <code>String ~ String</code>, yielding a <code>Command[Info]</code>.</p>
        <pre><code class="nohighlight"><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Info</span><span>(</span><span class="identifier">code</span><span>: </span><span class="type-name">String</span><span>, </span><span class="identifier">hos</span><span>: </span><span class="type-name">String</span><span>)

</span><span class="keyword">val</span><span> </span><span class="identifier">update2</span><span>: </span><span class="type-name">Command</span><span>[</span><span class="type-name">Info</span><span>] =
  </span><span class="string-literal">sql&quot;&quot;&quot;
    UPDATE country
    SET    headofstate = </span><span class="substitution">$varchar</span><span class="string-literal">
    WHERE  code = </span><span class="substitution">${bpchar(3)}</span><span class="string-literal">
  &quot;&quot;&quot;</span><span>.</span><span class="identifier">command</span><span>                                                         </span><span class="comment">// Command[String *: String *: EmptyTuple]
</span><span>     .</span><span class="identifier">contramap</span><span> { </span><span class="keyword">case</span><span> </span><span class="type-name">Info</span><span>(</span><span class="identifier">code</span><span>, </span><span class="identifier">hos</span><span>) =&gt; </span><span class="identifier">code</span><span> *: </span><span class="identifier">hos</span><span> *: </span><span class="type-name">EmptyTuple</span><span> } </span><span class="comment">// Command[Info]
// update2: Command[Info] = Command(
//   sql = &quot;&quot;&quot;
//     UPDATE country
//     SET    headofstate = $1
//     WHERE  code = $2
//   &quot;&quot;&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 102),
//   encoder = Encoder(varchar, bpchar(3))
// )</span></code></pre>
        <p>However in this case the mapping is entirely mechanical. Similar to <code>to</code> on query results, we can skip the boilerplate and <code>to</code> directly to an isomosphic case class.</p>
        <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">update3</span><span>: </span><span class="type-name">Command</span><span>[</span><span class="type-name">Info</span><span>] =
  </span><span class="string-literal">sql&quot;&quot;&quot;
    UPDATE country
    SET    headofstate = </span><span class="substitution">$varchar</span><span class="string-literal">
    WHERE  code = </span><span class="substitution">${bpchar(3)}</span><span class="string-literal">
  &quot;&quot;&quot;</span><span>.</span><span class="identifier">command</span><span>  </span><span class="comment">// Command[String *: String *: EmptyTuple]
</span><span>     .</span><span class="identifier">to</span><span>[</span><span class="type-name">Info</span><span>] </span><span class="comment">// Command[Info]
// update3: Command[Info] = Command(
//   sql = &quot;&quot;&quot;
//     UPDATE country
//     SET    headofstate = $1
//     WHERE  code = $2
//   &quot;&quot;&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 114),
//   encoder = Encoder(varchar, bpchar(3))
// )</span></code></pre>
        
        <h2 id="list-parameters" class="section"><a class="anchor-link left" href="#list-parameters"><i class="icofont-laika link">&#xef71;</i></a>List Parameters</h2>
        <p>Sometimes we want to repeat a parameter, for instance if we&#39;re using an <code>IN</code> clause. Here is a command that takes a <code>List[String]</code> as an argument and turns it into a list of <code>varchar</code>. We must specify the length when constructing the statement.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">deleteMany</span><span>(</span><span class="identifier">n</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Command</span><span>[</span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>]] =
  </span><span class="string-literal">sql&quot;DELETE FROM country WHERE name IN (</span><span class="substitution">${varchar.list(n)}</span><span class="string-literal">)&quot;</span><span>.</span><span class="identifier">command</span><span>

</span><span class="keyword">val</span><span> </span><span class="identifier">delete3</span><span> = </span><span class="identifier">deleteMany</span><span>(</span><span class="number-literal">3</span><span>) </span><span class="comment">// takes a list of size 3
// delete3: Command[List[String]] = Command(
//   sql = &quot;DELETE FROM country WHERE name IN ($1, $2, $3)&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 126),
//   encoder = Encoder(varchar, varchar, varchar)
// )</span></code></pre>
        <p>Sometimes we want to repeat a <em>group</em> of parameters, for instance if we&#39;re doing a bulk <code>INSERT</code>. To do this we take advantage of two combinators, first <code>.values</code> which takes an encoder and returns a new encoder that wraps its generated SQL in parens, and then <code>.list</code> as above.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">insertMany</span><span>(</span><span class="identifier">n</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Command</span><span>[</span><span class="type-name">List</span><span>[(</span><span class="type-name">String</span><span>, </span><span class="type-name">Short</span><span>)]] = {
  </span><span class="keyword">val</span><span> </span><span class="identifier">enc</span><span> = (</span><span class="identifier">varchar</span><span> ~ </span><span class="identifier">int2</span><span>).</span><span class="identifier">values</span><span>.</span><span class="identifier">list</span><span>(</span><span class="identifier">n</span><span>)
  </span><span class="string-literal">sql&quot;INSERT INTO pets VALUES </span><span class="substitution">$enc</span><span class="string-literal">&quot;</span><span>.</span><span class="identifier">command</span><span>
}

</span><span class="keyword">val</span><span> </span><span class="identifier">insert3</span><span> = </span><span class="identifier">insertMany</span><span>(</span><span class="number-literal">3</span><span>)
</span><span class="comment">// insert3: Command[List[(String, Short)]] = Command(
//   sql = &quot;INSERT INTO pets VALUES ($1, $2), ($3, $4), ($5, $6)&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 137),
//   encoder = Encoder(varchar, int2, varchar, int2, varchar, int2)
// )</span></code></pre>
        <p>You have no doubt noticed that there is a lack of safety with list parameters because the required length of the list is not represented in the type. In practice this is usually unavoidable because the length of the list is typically not known statically. However it is <em>also</em> typically the case that the command will be prepared with a specific list in mind, and in this case we can improve safety by passing the list itself (i.e., not just its length) to <code>.list</code>, and we get back an encoder that only works with that specific list.</p>
        <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">insertExactly</span><span>(</span><span class="identifier">ps</span><span>: </span><span class="type-name">List</span><span>[(</span><span class="type-name">String</span><span>, </span><span class="type-name">Short</span><span>)]): </span><span class="type-name">Command</span><span>[</span><span class="identifier">ps</span><span>.</span><span class="keyword">type</span><span>] = {
  </span><span class="keyword">val</span><span> </span><span class="identifier">enc</span><span> = (</span><span class="identifier">varchar</span><span> ~ </span><span class="identifier">int2</span><span>).</span><span class="identifier">values</span><span>.</span><span class="identifier">list</span><span>(</span><span class="identifier">ps</span><span>)
  </span><span class="string-literal">sql&quot;INSERT INTO pets VALUES </span><span class="substitution">$enc</span><span class="string-literal">&quot;</span><span>.</span><span class="identifier">command</span><span>
}

</span><span class="keyword">val</span><span> </span><span class="identifier">pairs</span><span> = </span><span class="type-name">List</span><span>[(</span><span class="type-name">String</span><span>, </span><span class="type-name">Short</span><span>)]((</span><span class="string-literal">&quot;Bob&quot;</span><span>, </span><span class="number-literal">3</span><span>), (</span><span class="string-literal">&quot;Alice&quot;</span><span>, </span><span class="number-literal">6</span><span>))
</span><span class="comment">// pairs: List[(String, Short)] = List((&quot;Bob&quot;, 3), (&quot;Alice&quot;, 6))
</span><span>
</span><span class="comment">// Note the type!
</span><span class="keyword">val</span><span> </span><span class="identifier">insertPairs</span><span> = </span><span class="identifier">insertExactly</span><span>(</span><span class="identifier">pairs</span><span>)
</span><span class="comment">// insertPairs: Command[pairs.type] = Command(
//   sql = &quot;INSERT INTO pets VALUES ($1, $2), ($3, $4)&quot;,
//   origin = Origin(file = &quot;Command.md&quot;, line = 149),
//   encoder = Encoder(varchar, int2, varchar, int2)
// )</span></code></pre>
        <p>We can pass <code>pairs</code> to <code>execute</code>.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">insertPairs</span><span>).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">pc</span><span> =&gt; </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">pairs</span><span>) }</span></code></pre>
        <p>However attempting to pass anything <em>other than</em> <code>pairs</code> is a type error.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// assume s: Session[IO]
</span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">insertPairs</span><span>).</span><span class="identifier">flatMap</span><span> { </span><span class="identifier">pc</span><span> =&gt; </span><span class="identifier">pc</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">pairs</span><span>.</span><span class="identifier">drop</span><span>(</span><span class="number-literal">1</span><span>)) }
</span><span class="comment">// error: type mismatch;
//  found   : List[(String, Short)]
//  required: repl.MdocSession.MdocApp.pairs.type
// s.prepare(insertPairs).flatMap { pc =&gt; pc.execute(pairs.drop(1)) }
//                                                             ^</span></code></pre>
        <p>See the full example below for a demonstration of these techniques.</p>
        
        <h2 id="summary-of-command-types" class="section"><a class="anchor-link left" href="#summary-of-command-types"><i class="icofont-laika link">&#xef71;</i></a>Summary of Command Types</h2>
        <p>The <em>simple command protocol</em> (i.e., <code>Session#execute</code>) is slightly more efficient in terms of message exchange, so use it if:</p>
        <ul>
          <li>Your command has no parameters; and</li>
          <li>you will be using the query only once per session.</li>
        </ul>
        <p>The <em>extend command protocol</em> (i.e., <code>Session#prepare</code>) is more powerful and more general, but requires additional network exchanges. Use it if:</p>
        <ul>
          <li>Your command has parameters; and/or</li>
          <li>you will be using the command more than once per session.</li>
        </ul>
        
        <h2 id="full-example" class="section"><a class="anchor-link left" href="#full-example"><i class="icofont-laika link">&#xef71;</i></a>Full Example</h2>
        <p>Here is a complete program listing that demonstrates our knowledge thus far, using the service pattern introduced earlier.</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="type-name">Monad</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">effect</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">all</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">natchez</span><span>.</span><span class="type-name">Trace</span><span>.</span><span class="type-name">Implicits</span><span>.</span><span class="identifier">noop</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">skunk</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">skunk</span><span>.</span><span class="identifier">codec</span><span>.</span><span class="identifier">all</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">skunk</span><span>.</span><span class="identifier">implicits</span><span>.</span><span class="identifier">_</span><span>

</span><span class="comment">// a data type
</span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Pet</span><span>(</span><span class="identifier">name</span><span>: </span><span class="type-name">String</span><span>, </span><span class="identifier">age</span><span>: </span><span class="type-name">Short</span><span>)

</span><span class="comment">// a service interface
</span><span class="keyword">trait</span><span> </span><span class="type-name">PetService</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]] {
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">insert</span><span>(</span><span class="identifier">pet</span><span>: </span><span class="type-name">Pet</span><span>): </span><span class="type-name">F</span><span>[</span><span class="type-name">Unit</span><span>]
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">insert</span><span>(</span><span class="identifier">ps</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">Pet</span><span>]): </span><span class="type-name">F</span><span>[</span><span class="type-name">Unit</span><span>]
  </span><span class="keyword">def</span><span> </span><span class="declaration-name">selectAll</span><span>: </span><span class="type-name">F</span><span>[</span><span class="type-name">List</span><span>[</span><span class="type-name">Pet</span><span>]]
}

</span><span class="comment">// a companion with a constructor
</span><span class="keyword">object</span><span> </span><span class="type-name">PetService</span><span> {

  </span><span class="comment">// command to insert a pet
</span><span>  </span><span class="keyword">private</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">insertOne</span><span>: </span><span class="type-name">Command</span><span>[</span><span class="type-name">Pet</span><span>] =
    </span><span class="string-literal">sql&quot;INSERT INTO pets VALUES (</span><span class="substitution">$varchar</span><span class="string-literal">, </span><span class="substitution">$int2</span><span class="string-literal">)&quot;</span><span>
      .</span><span class="identifier">command</span><span>
      .</span><span class="identifier">to</span><span>[</span><span class="type-name">Pet</span><span>]

  </span><span class="comment">// command to insert a specific list of pets
</span><span>  </span><span class="keyword">private</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">insertMany</span><span>(</span><span class="identifier">ps</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">Pet</span><span>]): </span><span class="type-name">Command</span><span>[</span><span class="identifier">ps</span><span>.</span><span class="keyword">type</span><span>] = {
    </span><span class="keyword">val</span><span> </span><span class="identifier">enc</span><span> = (</span><span class="identifier">varchar</span><span> *: </span><span class="identifier">int2</span><span>).</span><span class="identifier">to</span><span>[</span><span class="type-name">Pet</span><span>].</span><span class="identifier">values</span><span>.</span><span class="identifier">list</span><span>(</span><span class="identifier">ps</span><span>)
    </span><span class="string-literal">sql&quot;INSERT INTO pets VALUES </span><span class="substitution">$enc</span><span class="string-literal">&quot;</span><span>.</span><span class="identifier">command</span><span>
  }

  </span><span class="comment">// query to select all pets
</span><span>  </span><span class="keyword">private</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">all</span><span>: </span><span class="type-name">Query</span><span>[</span><span class="type-name">Void</span><span>, </span><span class="type-name">Pet</span><span>] =
    </span><span class="string-literal">sql&quot;SELECT name, age FROM pets&quot;</span><span>
      .</span><span class="identifier">query</span><span>(</span><span class="identifier">varchar</span><span> *: </span><span class="identifier">int2</span><span>)
      .</span><span class="identifier">to</span><span>[</span><span class="type-name">Pet</span><span>]

  </span><span class="comment">// construct a PetService
</span><span>  </span><span class="keyword">def</span><span> </span><span class="declaration-name">fromSession</span><span>[</span><span class="type-name">F</span><span>[</span><span class="identifier">_</span><span>]: </span><span class="type-name">Monad</span><span>](</span><span class="identifier">s</span><span>: </span><span class="type-name">Session</span><span>[</span><span class="type-name">F</span><span>]): </span><span class="type-name">PetService</span><span>[</span><span class="type-name">F</span><span>] =
    </span><span class="keyword">new</span><span> </span><span class="type-name">PetService</span><span>[</span><span class="type-name">F</span><span>] {
      </span><span class="keyword">def</span><span> </span><span class="declaration-name">insert</span><span>(</span><span class="identifier">pet</span><span>: </span><span class="type-name">Pet</span><span>): </span><span class="type-name">F</span><span>[</span><span class="type-name">Unit</span><span>] = </span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">insertOne</span><span>).</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">_</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">pet</span><span>)).</span><span class="identifier">void</span><span>
      </span><span class="keyword">def</span><span> </span><span class="declaration-name">insert</span><span>(</span><span class="identifier">ps</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">Pet</span><span>]): </span><span class="type-name">F</span><span>[</span><span class="type-name">Unit</span><span>] = </span><span class="identifier">s</span><span>.</span><span class="identifier">prepare</span><span>(</span><span class="identifier">insertMany</span><span>(</span><span class="identifier">ps</span><span>)).</span><span class="identifier">flatMap</span><span>(</span><span class="identifier">_</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">ps</span><span>)).</span><span class="identifier">void</span><span>
      </span><span class="keyword">def</span><span> </span><span class="declaration-name">selectAll</span><span>: </span><span class="type-name">F</span><span>[</span><span class="type-name">List</span><span>[</span><span class="type-name">Pet</span><span>]] = </span><span class="identifier">s</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="identifier">all</span><span>)
    }

}

</span><span class="keyword">object</span><span> </span><span class="type-name">CommandExample</span><span> </span><span class="keyword">extends</span><span> </span><span class="type-name">IOApp</span><span> {

  </span><span class="comment">// a source of sessions
</span><span>  </span><span class="keyword">val</span><span> </span><span class="identifier">session</span><span>: </span><span class="type-name">Resource</span><span>[</span><span class="type-name">IO</span><span>, </span><span class="type-name">Session</span><span>[</span><span class="type-name">IO</span><span>]] =
    </span><span class="type-name">Session</span><span>.</span><span class="identifier">single</span><span>(
      </span><span class="identifier">host</span><span>     = </span><span class="string-literal">&quot;localhost&quot;</span><span>,
      </span><span class="identifier">user</span><span>     = </span><span class="string-literal">&quot;jimmy&quot;</span><span>,
      </span><span class="identifier">database</span><span> = </span><span class="string-literal">&quot;world&quot;</span><span>,
      </span><span class="identifier">password</span><span> = </span><span class="type-name">Some</span><span>(</span><span class="string-literal">&quot;banana&quot;</span><span>),
    )

  </span><span class="comment">// a resource that creates and drops a temporary table
</span><span>  </span><span class="keyword">def</span><span> </span><span class="declaration-name">withPetsTable</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">Session</span><span>[</span><span class="type-name">IO</span><span>]): </span><span class="type-name">Resource</span><span>[</span><span class="type-name">IO</span><span>, </span><span class="type-name">Unit</span><span>] = {
    </span><span class="keyword">val</span><span> </span><span class="identifier">alloc</span><span> = </span><span class="identifier">s</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="string-literal">sql&quot;CREATE TEMP TABLE pets (name varchar, age int2)&quot;</span><span>.</span><span class="identifier">command</span><span>).</span><span class="identifier">void</span><span>
    </span><span class="keyword">val</span><span> </span><span class="identifier">free</span><span>  = </span><span class="identifier">s</span><span>.</span><span class="identifier">execute</span><span>(</span><span class="string-literal">sql&quot;DROP TABLE pets&quot;</span><span>.</span><span class="identifier">command</span><span>).</span><span class="identifier">void</span><span>
    </span><span class="type-name">Resource</span><span>.</span><span class="identifier">make</span><span>(</span><span class="identifier">alloc</span><span>)(</span><span class="identifier">_</span><span> =&gt; </span><span class="identifier">free</span><span>)
  }

  </span><span class="comment">// some sample data
</span><span>  </span><span class="keyword">val</span><span> </span><span class="identifier">bob</span><span>     = </span><span class="type-name">Pet</span><span>(</span><span class="string-literal">&quot;Bob&quot;</span><span>, </span><span class="number-literal">12</span><span>)
  </span><span class="keyword">val</span><span> </span><span class="identifier">beagles</span><span> = </span><span class="type-name">List</span><span>(</span><span class="type-name">Pet</span><span>(</span><span class="string-literal">&quot;John&quot;</span><span>, </span><span class="number-literal">2</span><span>), </span><span class="type-name">Pet</span><span>(</span><span class="string-literal">&quot;George&quot;</span><span>, </span><span class="number-literal">3</span><span>), </span><span class="type-name">Pet</span><span>(</span><span class="string-literal">&quot;Paul&quot;</span><span>, </span><span class="number-literal">6</span><span>), </span><span class="type-name">Pet</span><span>(</span><span class="string-literal">&quot;Ringo&quot;</span><span>, </span><span class="number-literal">3</span><span>))

  </span><span class="comment">// our entry point
</span><span>  </span><span class="keyword">def</span><span> </span><span class="declaration-name">run</span><span>(</span><span class="identifier">args</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>]): </span><span class="type-name">IO</span><span>[</span><span class="type-name">ExitCode</span><span>] =
    </span><span class="identifier">session</span><span>.</span><span class="identifier">flatTap</span><span>(</span><span class="identifier">withPetsTable</span><span>).</span><span class="identifier">map</span><span>(</span><span class="type-name">PetService</span><span>.</span><span class="identifier">fromSession</span><span>(</span><span class="identifier">_</span><span>)).</span><span class="identifier">use</span><span> { </span><span class="identifier">s</span><span> =&gt;
      </span><span class="keyword">for</span><span> {
        </span><span class="identifier">_</span><span>  &lt;- </span><span class="identifier">s</span><span>.</span><span class="identifier">insert</span><span>(</span><span class="identifier">bob</span><span>)
        </span><span class="identifier">_</span><span>  &lt;- </span><span class="identifier">s</span><span>.</span><span class="identifier">insert</span><span>(</span><span class="identifier">beagles</span><span>)
        </span><span class="identifier">ps</span><span> &lt;- </span><span class="identifier">s</span><span>.</span><span class="identifier">selectAll</span><span>
        </span><span class="identifier">_</span><span>  &lt;- </span><span class="identifier">ps</span><span>.</span><span class="identifier">traverse</span><span>(</span><span class="identifier">p</span><span> =&gt; </span><span class="type-name">IO</span><span>.</span><span class="identifier">println</span><span>(</span><span class="identifier">p</span><span>))
      } </span><span class="keyword">yield</span><span> </span><span class="type-name">ExitCode</span><span>.</span><span class="type-name">Success</span><span>
    }

}</span></code></pre>
        <p>Running this program yields the following.</p>
        <pre><code>Pet(Bob,12)
Pet(John,2)
Pet(George,3)
Pet(Paul,6)
Pet(Ringo,3)</code></pre>
        
        <h2 id="experiment" class="section"><a class="anchor-link left" href="#experiment"><i class="icofont-laika link">&#xef71;</i></a>Experiment</h2>
        <ul>
          <li>Change <code>insertMany</code> to pass an <code>Int</code> to <code>.list</code> and then pass a size other than the length of <code>beagles</code> and observe the error.</li>
          <li>Add a unique constraint on <code>name</code> in the DDL and then violate it by inserting two pets with the same name. Follow the hint in the error message to add an handler that recovers gracefully.</li>
          <li>Change the service constructor to prepare the statements once on construction, rather than each time <code>insert</code> is called.</li>
        </ul>

        
<hr class="footer-rule"/>
<footer>
  skunk is a <a href="https://typelevel.org/">Typelevel</a> project distributed under the <a href="https://opensource.org/licenses/MIT">MIT</a> license.
</footer>


      </main>

    </div>

  </body>

</html>